<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta http-equiv=" X-UA-Compatible" content="ie=edge">

    <meta name="theme-color" content="#13A699" />

    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="KepTung">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <title>‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏±‡∏á‡∏Ñ‡πå | KepTung</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Kanit&display=swap" rel="stylesheet">
    <style>
        body {
            /* padding: 1em; */
            background: #eeeeee;
            /* background-color: #404040; */
            font-family: 'Kanit', sans-serif;
        }

        nav {
            background: #13A699;
            color: white;
            text-align: left;
            padding: .5em;
            position: absolute;
            left: 0;
            right: 0;
        }

        .page {
            padding: 1em;
            padding-top: 60px;
        }

        button {
            background: #13A699;
            border-radius: .3em;
            font-size: 1rem;
            color: white;
            width: 100%;
            padding: 1em;
            box-sizing: border-box;
            border: none;
        }

        button:hover {
            cursor: pointer;
        }

        input {
            width: 100%;
            border-radius: .3em;
            font-size: 1rem;
            padding: .5em .5em;
            box-sizing: border-box;
            border: 1px solid #ccc;
            margin-bottom: 1em;
        }

        .saving {
            text-align: center;
        }

        .detail {
            margin-bottom: 40px;
            margin-top: 40px;
        }

        #page-setting,
        #page-saving {
            display: none;
        }

        #list-goal {
            height: 320px;
        }
    </style>
</head>

<body>
    <div class='container-fluid bg-light col-md-6'>
        <nav>KepTung üí∞</nav>
        <div id="page-home" class="page">
            <h2>‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
            <div id="list-goal">
            </div>
            <button onclick="mockupClick('page-home','page-setting')">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</button>
        </div>

        <div id="page-setting" class="page">
            <h3>‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏±‡∏á‡∏Ñ‡πå</h3>
            <input type='text' id='goal' placeholder='‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢'></input>
            <input type='number' id='amount' placeholder='‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô'></input>
            <label for="Inputstartdate">‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
            <input type='date' id='startdate'></input>
            <label for="inputenddate">‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
            <input type='date' id='enddate'></input>
            <label for="inputfrequency">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà</label>
            <select id="frequency" class="form-control">
                <option value="‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</option>
                <option value="‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå">‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</option>
                <option value="‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
            </select><br>
            <button onclick="calculate()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </div>

        <div id="page-saving" class="page">
            <h1 id='curgoal' class="text-center"></h1>
            <div class="row">
                <div class="col-6">
                    <div id='showdate'></div>
                    <div id='day_count'></div>
                </div>
                <p id='countdowndate' class="text-right col-6"></p>
            </div>

            <div class="saving">
                <small>‡∏¢‡∏≠‡∏î‡πÄ‡∏Å‡πá‡∏ö/‡∏Ñ‡∏£‡∏±‡πâ‡∏á</small>
                <h1 id='saving_amount' style="color: #7CB342;"></h1><small id='showfrequency'></small>
            </div>

            <div class="detail">
                <div class="progress">
                    <div id='progress_bar' class="progress-bar progress-bar-striped bg-success" role="progressbar"
                        aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">7%</div>
                </div>
                <div class="row">
                    <div id='store_amount' class="col-6"></div>
                    <div id="goal_amount" class="col-6" style="text-align:right;"></div>
                </div>
            </div>
            <button onclick="mockupClick('page-saving','page-home')">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
        </div>
    </div>
    <div class="footer text-right mt-2 p-2 text-dark text-center">
        <small>*‡πÄ‡∏®‡∏©‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</small><br />
        <small>KepTung by ckrittima</small>
        <!-- <small>KepTung by <a href="https://github.com/ckrittima" style="color:#13A699">@ckrittima ü•¨</a></small> -->
    </div>

    <script>
        let date = new Date();
        document.getElementById("startdate").max = `${date.getFullYear()}-${date.getMonth()}-${date.getDay()}`;
        document.getElementById("enddate").min = new Date();


        function mockupClick(pageToHide, pageToShow) {
            document.querySelector('#' + pageToHide).style.display = "none ";
            document.querySelector('#' + pageToShow).style.display = "block ";
        }

        function calculate() {
            var amount = document.getElementById('amount').value;
            var startdate = document.getElementById('startdate').value;
            var enddate = document.getElementById('enddate').value;
            var freq = document.getElementById('frequency').value;

            var date1 = new Date(startdate);
            var date2 = new Date(enddate);
            var time_dif = date2.getTime() - date1.getTime();
            var day_diff = time_dif / (1000 * 3600 * 24);

            let saving_amount = 0;
            if (freq == '‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô') {
                saving_amount = Math.ceil(amount / day_diff);
            } else if (freq == '‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå') {
                let weekly = Math.ceil(day_diff / 7);
                saving_amount = Math.ceil(amount / weekly);
            } else if (freq == '‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô') {
                let monthly = Math.ceil(day_diff / 30);
                saving_amount = Math.ceil(amount / monthly);
            }
            document.getElementById('saving_amount').innerHTML = saving_amount;
            calPercent(saving_amount)
            showdetail();
            mockupClick('page-setting', 'page-saving');
        }

        function calPercent(saving_amount) {
            var amount = document.getElementById('amount').value;
            var startdate = document.getElementById('startdate').value;
            var enddate = document.getElementById('enddate').value;

            var c_date = new Date();
            var e_date = new Date(enddate);
            var currentDate = c_date.getDate() + '/' + (c_date.getMonth() + 1) + '/' + c_date.getFullYear();
            var s_date = new Date(startdate);
            var t_dif = c_date.getTime() - s_date.getTime();
            var t_diff2 = e_date.getTime() - c_date.getTime();
            // console.log(t_diff2)
            var day_count = t_dif / (1000 * 3600 * 24);
            var remain_day = t_diff2 / (1000 * 3600 * 24);
            var store_amount = saving_amount * parseInt(day_count);
            var percent = ((store_amount / amount) * 100).toFixed(0);
            document.getElementById('store_amount').innerHTML = parseInt(store_amount);
            document.getElementById('day_count').innerHTML = '<p>D-' + day_count.toFixed(0) + '</p>';
            if (remain_day < 0){
                remain_day = 0;
                document.getElementById('countdowndate').innerHTML = '‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å <br>' + remain_day.toFixed(0) + ' ‡∏ß‡∏±‡∏ô';
            } else {
                document.getElementById('countdowndate').innerHTML = '‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å <br>' + remain_day.toFixed(0) + ' ‡∏ß‡∏±‡∏ô';
            }
            document.getElementById('progress_bar').style.width = percent + '%';
            document.getElementById('progress_bar').innerHTML = percent + '%';
            
        }
        function showdetail() {
            var title = document.getElementById('goal').value;
            var amount = document.getElementById('amount').value;
            var freq = document.getElementById('frequency').value;
            document.getElementById('curgoal').innerHTML = title;
            document.getElementById('showfrequency').innerHTML = '(' + freq + ')';
            document.getElementById('goal_amount').innerHTML = amount;
        }

        function getNowDate() {
            var d = new Date();
            var currentDate = new Date();
            var day = currentDate.getDate();
            var month = currentDate.getMonth() + 1;
            var year = currentDate.getFullYear();
            document.getElementById('showdate').innerHTML = day + "/" + month + "/" + year;
        }
        getNowDate()
    </script>
</body>

</html>